"use strict";(globalThis.webpackChunkfirst_example=globalThis.webpackChunkfirst_example||[]).push([[8732],{28453:(e,n,t)=>{t.d(n,{R:()=>l,x:()=>s});var a=t(96540);const i={},r=a.createContext(i);function l(e){const n=a.useContext(r);return a.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),a.createElement(r.Provider,{value:n},e.children)}},54027:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>s,default:()=>h,frontMatter:()=>l,metadata:()=>a,toc:()=>d});const a=JSON.parse('{"id":"user-guide/adapter/healthCheck","title":"HealthCheck","description":"KadaiAdapter also provides a way to monitor its health - built on top","source":"@site/docs/user-guide/adapter/healthCheck.md","sourceDirName":"user-guide/adapter","slug":"/user-guide/adapter/healthCheck","permalink":"/kadai-doc/docs/user-guide/adapter/healthCheck","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3},"sidebar":"userSidebar","previous":{"title":"Architecture","permalink":"/kadai-doc/docs/user-guide/adapter/architecture"},"next":{"title":"Declarations","permalink":"/kadai-doc/docs/category/declarations"}}');var i=t(74848),r=t(28453);const l={sidebar_position:3},s="HealthCheck",o={},d=[{value:"Kernel",id:"kernel",level:2},{value:"Kadai",id:"kadai",level:3},{value:"Scheduler",id:"scheduler",level:3},{value:"Plugins",id:"plugins",level:2},{value:"Camunda 7",id:"camunda-7",level:3},{value:"Example-Response",id:"example-response",level:4},{value:"Camunda Systems",id:"camunda-systems",level:4},{value:"Camunda System",id:"camunda-system",level:4},{value:"Camunda",id:"camunda",level:4},{value:"Outbox",id:"outbox",level:4},{value:"Camunda 8",id:"camunda-8",level:3},{value:"Example-Response",id:"example-response-1",level:4},{value:"Job-Worker",id:"job-worker",level:4},{value:"Create (Job-Worker)",id:"create-job-worker",level:4},{value:"Complete (Job-Worker)",id:"complete-job-worker",level:4},{value:"Cancel (Job-Worker)",id:"cancel-job-worker",level:4},{value:"Register a Health-Indicator for your own plugin",id:"register-a-health-indicator-for-your-own-plugin",level:3},{value:"Partially disabling Health-Indicators",id:"partially-disabling-health-indicators",level:2}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"healthcheck",children:"HealthCheck"})}),"\n",(0,i.jsxs)(n.p,{children:["KadaiAdapter also provides a way to monitor its health - built on top\nof ",(0,i.jsx)(n.a,{href:"https://docs.spring.io/spring-boot/reference/actuator/index.html",children:"SpringBoot Actuator"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["Assuming that the adapter application runs at ",(0,i.jsx)(n.code,{children:"http://localhost:8082"})," you can request below URL for\nall health-information:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"GET http://localhost:8082/actuator/health\n"})}),"\n",(0,i.jsx)(n.h2,{id:"kernel",children:"Kernel"}),"\n",(0,i.jsx)(n.p,{children:"The hierarchical nature allows to just request health information for specific sub-systems, e.g. all\nkernel-components:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",metastring:'title="GET http://localhost:8082/actuator/health/kadaiAdapter/kernel"',children:'{\n  "status": "UP",\n  "components": {\n    "kadai": {\n      "status": "UP",\n      "details": {\n        "kadaiVersion": "11.0.1-SNAPSHOT"\n      }\n    },\n    "scheduler": {\n      "status": "UP",\n      "components": {\n        "kadaiTaskStarter": {\n          "status": "UP",\n          "details": {\n            "lastRun": "2025-10-07T10:39:18.036280700Z",\n            "expectedNextRunBefore": "2025-10-07T10:39:38.185300900Z",\n            "expectedRunTime": 149\n          }\n        },\n        "kadaiTaskTerminator": {\n          "status": "UP",\n          "details": {\n            "lastRun": "2025-10-07T10:39:18.045281300Z",\n            "expectedNextRunBefore": "2025-10-07T10:39:38.064082400Z",\n            "expectedRunTime": 18\n          }\n        },\n        "referencedTaskClaimCanceler": {\n          "status": "UP",\n          "details": {\n            "lastRun": "2025-10-07T10:39:18.065285700Z",\n            "expectedNextRunBefore": "2025-10-07T10:39:38.103276500Z",\n            "expectedRunTime": 37\n          }\n        },\n        "referencedTaskClaimer": {\n          "status": "UP",\n          "details": {\n            "lastRun": "2025-10-07T10:39:18.065285700Z",\n            "expectedNextRunBefore": "2025-10-07T10:39:38.103276500Z",\n            "expectedRunTime": 37\n          }\n        },\n        "referencedTaskCompleter": {\n          "status": "UP",\n          "details": {\n            "lastRun": "2025-10-07T10:39:18.065285700Z",\n            "expectedNextRunBefore": "2025-10-07T10:39:38.103276500Z",\n            "expectedRunTime": 37\n          }\n        }\n      }\n    }\n  }\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"kadai",children:"Kadai"}),"\n",(0,i.jsxs)(n.p,{children:["When healthy, it should return the ",(0,i.jsx)(n.code,{children:"KADAI"})," version being used"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"kadaiVersion"})," specifies the current running version of ",(0,i.jsx)(n.code,{children:"KADAI"})]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"scheduler",children:"Scheduler"}),"\n",(0,i.jsx)(n.p,{children:"Health-Composite, healthy if all Health-Contributors are healthy."}),"\n",(0,i.jsx)(n.p,{children:"Each Health-Contributor provides the following information:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"lastRun"}),": The last successfully reported run"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"expectedNextRunBefore"}),": The latest point in time the next scheduled run is expected to have been\nreported successful"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"expectedRunTime"}),": The expected run-time in milliseconds for a single run of the scheduled\nfunctionality, reported as lower median"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["If any of the services is not running properly, the overall status will be ",(0,i.jsx)(n.code,{children:"DOWN"})," and the error will\nbe shown in the ",(0,i.jsx)(n.code,{children:'"details"'}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"expectedNextRunBefore"})," can be configured by supplying an acceptance-multiplier for threshold.\nIt determines ",(0,i.jsx)(n.code,{children:"expectedNextRunBefore = run-time-acceptance-multiplier * expectedRunTime + lastRun"}),".\nIt can be set via:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-properties",metastring:'title="application.properties"',children:"management.health.kadai-adapter.kernel.scheduler.run-time-acceptance-multiplier=42\n"})}),"\n",(0,i.jsx)(n.h2,{id:"plugins",children:"Plugins"}),"\n",(0,i.jsx)(n.h3,{id:"camunda-7",children:"Camunda 7"}),"\n",(0,i.jsxs)(n.p,{children:["The URLs for the Camunda7-Systems are derived from the property\n",(0,i.jsx)(n.code,{children:"kadai-system-connector-camundaSystemURLs"}),"."]}),"\n",(0,i.jsx)(n.h4,{id:"example-response",children:"Example-Response"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",metastring:'title="http://localhost:8082/actuator/health/kadaiAdapter/plugin/camunda7"',children:'{\n  "status": "UP",\n  "components": {\n    "camundaSystem1": {\n      "status": "UP",\n      "components": {\n        "camunda": {\n          "status": "UP",\n          "details": {\n            "camundaEngines": [\n              {\n                "name": "default"\n              }\n            ],\n            "baseUrl": "http://localhost:8081/example-context-root/engine-rest/engine"\n          }\n        },\n        "outbox": {\n          "status": "UP",\n          "details": {\n            "outboxService": {\n              "eventsCount": 0\n            },\n            "baseUrl": "http://localhost:8081/example-context-root/outbox-rest"\n          }\n        }\n      }\n    }\n  }\n}\n'})}),"\n",(0,i.jsx)(n.h4,{id:"camunda-systems",children:"Camunda Systems"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"camunda7"})," contains a composite of Camunda7-Systems"]}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"camunda-system",children:"Camunda System"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"camundaSystem[i]"})," contains the health of the i-th Camunda- and Outbox-Component"]}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"camunda",children:"Camunda"}),"\n",(0,i.jsx)(n.p,{children:"When healthy, it should return a list of the available Camunda Engines"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"camundaEngines"})," lists the available Camunda engines by name."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"baseUrl"})," shows the base URL for the Camunda REST"]}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"outbox",children:"Outbox"}),"\n",(0,i.jsx)(n.p,{children:"When healthy, it should return the count of events in the outbox"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"outboxService.eventsCount"})," represents the number of unprocessed events in the outbox"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"baseUrl"})," shows the base URL for the Outbox REST"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"camunda-8",children:"Camunda 8"}),"\n",(0,i.jsxs)(n.p,{children:["Unlike Camunda7 we do not include the health of the Camunda8-instance itself in here.\nYou can inspect that separately with the Health-Endpoints provided by Camunda,\nsee ",(0,i.jsx)(n.a,{href:"https://docs.camunda.io/docs/self-managed/components/orchestration-cluster/zeebe/operations/health/",children:"Orchestration-Cluster/Zeebee/Health"}),"."]}),"\n",(0,i.jsx)(n.h4,{id:"example-response-1",children:"Example-Response"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",metastring:'title="http://localhost:8082/actuator/health/kadaiAdapter/plugin/camunda8"',children:'{\n  "status": "UP",\n  "components": {\n    "jobWorker": {\n      "status": "UP",\n      "components": {\n        "complete": {\n          "status": "UNKNOWN",\n          "details": {\n            "lastRun": null,\n            "expectedRunTime": 0\n          }\n        },\n        "create": {\n          "status": "UP",\n          "details": {\n            "lastRun": "2025-10-16T08:55:19.287769500Z",\n            "expectedRunTime": 55\n          }\n        },\n        "cancel": {\n          "status": "UP",\n          "details": {\n            "lastRun": "2025-10-16T08:55:20.474158400Z",\n            "expectedRunTime": 74\n          }\n        }\n      }\n    }\n  }\n}\n'})}),"\n",(0,i.jsx)(n.h4,{id:"job-worker",children:"Job-Worker"}),"\n",(0,i.jsx)(n.p,{children:"The health-composite of all job-workers."}),"\n",(0,i.jsx)(n.h4,{id:"create-job-worker",children:"Create (Job-Worker)"}),"\n",(0,i.jsx)(n.p,{children:"The health-indicator for the job-worker responsible for reacting to user-tasks being created."}),"\n",(0,i.jsx)(n.h4,{id:"complete-job-worker",children:"Complete (Job-Worker)"}),"\n",(0,i.jsx)(n.p,{children:"The health-indicator for the job-worker responsible for reacting to user-tasks being completed."}),"\n",(0,i.jsx)(n.h4,{id:"cancel-job-worker",children:"Cancel (Job-Worker)"}),"\n",(0,i.jsx)(n.p,{children:"The health-indicator for the job-worker responsible for reacting to user-tasks being cancelled."}),"\n",(0,i.jsx)(n.h3,{id:"register-a-health-indicator-for-your-own-plugin",children:"Register a Health-Indicator for your own plugin"}),"\n",(0,i.jsxs)(n.p,{children:["The starting-point for registering health-indicators for your own plugins is interface\n",(0,i.jsx)(n.code,{children:"PluginHealthContributorFactory"}),"."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",metastring:'title="io.kadai.adapter.monitoring.PluginHealthContributorFactory"',children:"/**\n * Instantiated factory for KadaiAdapter-specific plugin-health-contributors.\n *\n * <p>Implement this interface for any contributing Health-Indicators.\n *\n * <p>Implementations of this interface will be picked up by {@link KadaiAdapterHealth} via\n * <b>classpath-scanning</b> in a SpringBoot-Application. Therefore, you <b>need to</b> lift your\n * implementation into the Spring-Context, e.g. by annotating it as {@code @Component}.\n */\npublic interface PluginHealthContributorFactory {\n\n  /**\n   * Returns the name of the plugin.\n   *\n   * <p>This name will be used as an <b>identifier</b> for Health-Contributors created by\n   * <i>this</i> factory. It will further be used as JSON-Field in the actuators' health-response.\n   *\n   * @return name of the plugin\n   */\n  String getPluginName();\n\n  /**\n   * Returns an optional instance of the Health-Contributor created by <i>this factory</i>.\n   *\n   * <p>It may return {@link Optional#empty()}, e.g. to control activation of this plugin through\n   * extra properties.\n   *\n   * @return an optional instance of the Health-Contributor\n   */\n  Optional<HealthContributor> newInstance();\n}\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Implement it and make sure your implementing class can be picked-up by Spring, e.g. by annotating it\nwith ",(0,i.jsx)(n.code,{children:"@Component"}),".\nThat's it! The KadaiAdapter will now automatically pick up your implementation and expose it via\nactuator.\nIt may then look like this:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",metastring:'title="my.org.kadai.adapter.plugin.monitoring.MyPluginHealthContributorFactory"',children:'\n@Component\npublic class MyPluginHealthContributorFactory implements PluginHealthContributorFactory {\n\n  @Override\n  public String getPluginName() {\n    return "my-plugin";\n  }\n\n  @Override\n  public Optional<HealthContributor> newInstance() {\n    final MyHealthContributor myHealthContributor = new MyHealthContributor();\n    return Optional.of(myHealthContributor); // HealthComposite or -Indicator - whatever you wish!\n  }\n}\n'})}),"\n",(0,i.jsx)(n.h2,{id:"partially-disabling-health-indicators",children:"Partially disabling Health-Indicators"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"By default"}),", all kernel- as well as all found plugin-health-composites and -indicators are\n",(0,i.jsx)(n.strong,{children:"enabled"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["The KadaiAdapter-Health is a Rose-Tree where the root is ",(0,i.jsx)(n.code,{children:"kadaiAdapter"})," - the composite of all\nHealth-indicators related to the KadaiAdapter.\nBranches are ",(0,i.jsxs)(n.a,{href:"https://docs.spring.io/spring-boot/api/java/org/springframework/boot/actuate/health/CompositeHealthContributor.html",children:["\n",(0,i.jsx)(n.code,{children:"Health-Composites"})]})," -\nthemselves composed of Health-Trees.\nLeafs are ",(0,i.jsxs)(n.a,{href:"https://docs.spring.io/spring-boot/api/java/org/springframework/boot/actuate/health/HealthIndicator.html",children:["\n",(0,i.jsx)(n.code,{children:"Health-Indicators"})]}),".\nIn this tree you can"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["fully disable any branch ",(0,i.jsx)(n.code,{children:"branch"})," (composite) and it's children by setting\n",(0,i.jsx)(n.code,{children:"management.health.kadai-adapter.branch.enabled=false"}),", e.g.:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"management.health.kadai-adapter.kernel.enabled=false"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"management.health.kadai-adapter.plugin.enabled=false"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"management.health.kadai-adapter.plugin.camunda7.enabled=false"})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["partially disable any of a composites contributors ",(0,i.jsx)(n.code,{children:"contributor"})," by setting\n",(0,i.jsx)(n.code,{children:"management.health.kadai-adapter.branch.contributor.enabled=false"}),", e.g.:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"management.health.kadai-adapter.kernel.kadai.enabled=false"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"management.health.kadai-adapter.kernel.kadai.scheduler=false"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"management.health.kadai-adapter.plugin.camunda7.outbox.enabled=false"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"management.health.kadai-adapter.kernel.scheduler.kadai-task-terminator.enabled=false"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"This schema applies to all parts of the KadaiAdapter-HealthCheck."})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}}}]);